' Reputation System Master Diagram
@startuml
!theme spacelab

' === Actors ===
actor User
actor TO as "Tournament Organizer"
actor Admin as "Site Admin"
actor System as "Platform System"
actor ReviewBoard as "Review Board"

' === Main Entities ===
entity "UserProfile" as Profile
entity "Tournament"
entity "PlayerConductEvent" as Event
entity "UserReputationScore" as Score
entity "UserIP"
entity "Appeal"
entity "Evidence"
entity "AuditLog"

' === User Flows ===
User --> Profile : registers/participates
User --> Tournament : registers for
User --> System : views own conduct record & score
User --> System : submits appeal
User --> System : receives notifications

TO --> Tournament : organizes
TO --> System : logs conduct event
TO --> System : logs positive event
TO --> System : views conduct records (their tournaments)
TO --> System : receives notifications

Admin --> System : reviews appeals
Admin --> System : manages event types
Admin --> System : views all conduct records & scores
Admin --> System : manages privacy/data

ReviewBoard --> System : reviews appeals (future: democratic, regional reps)

' === Event Logging ===
System --> Event : create (positive/negative)
System --> Evidence : attach (required for all events)
Event --> Profile : for user
Event --> Tournament : in tournament
Event --> TO : by organizer
Event --> Evidence : has evidence
Event --> Appeal : can be appealed
Event --> Score : affects score

' === Score Calculation & Decay ===
System --> Score : recalculate (on event, decay, or scheduled)
Score --> Profile : belongs to user
Score --> Event : based on active (non-decayed) events

' === Appeals ===
User --> Appeal : submits (within 7 days)
Appeal --> Event : references
Appeal --> Evidence : can attach
System --> ReviewBoard : notifies
System --> TO : notifies (original event logger)
ReviewBoard --> Appeal : reviews, votes
System --> Appeal : updates status (PENDING/APPROVED/REJECTED)
System --> AuditLog : logs all actions

' === Positive Event Automation ===
System --> Event : auto-log positive (sentiment analysis, engagement, articles)
System --> Score : update

' === Privacy & IP Tracking ===
User --> UserIP : can opt in/out (required for some tournaments)
System --> UserIP : logs IP on participation
UserIP --> Profile : belongs to user
System --> UserIP : flags for ban evasion
System --> Admin : restricts access to IP data
System --> AuditLog : logs access

' === Notifications ===
System --> User : notifies (score change, event, appeal status)
System --> TO : notifies (event, appeal status)
System --> Admin : notifies (appeal, abuse monitoring)

' === Data Retention & Security ===
System --> UserIP : retains for 6+ months after ban/exit
System --> Event : events are permanent (impact decays)
System --> AuditLog : logs all changes/actions
System --> Evidence : stores securely

' === UI/UX Touchpoints (as notes) ===
note right of User
  - Dashboard: view score, events, appeal
  - Appeal modal: submit statement, evidence
  - Score gauge, event timeline, badges
end note

note right of TO
  - Dashboard: log events, nominate positive, monitor
  - View conduct records (own tournaments)
end note

note right of Admin
  - Admin panel: review appeals, manage types, monitor abuse
  - Full access to audit logs, privacy controls
end note

note right of System
  - Automated positive event triggers
  - Scheduled score decay jobs
  - Privacy policy display & consent
end note

@enduml 